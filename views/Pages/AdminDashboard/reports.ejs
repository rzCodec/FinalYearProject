<!DOCTYPE html>
<html lang="en" >
<head >
    <%- include ../../Partials/AboveFold.ejs %>
</head >
<body >
<main >
    <div class="row" >
        <%- include ./partials/nav.ejs %>

        <div class="col s10 offset-s2 container" >
            <div class="valign-wrapper" >
                <h2 class="center-align" style='width:100%;' >Reports</h2 >
            </div >
            <ul id="staggered-test" >
                <li class="" style="transform: translateX(0px); opacity: 0; " >
                    <div class="row" >
                        <div class="col s6 container" >
                            <div class="card white darken-4 black-text" >
                                <div class="card-content" >
                                    <h1 class="center-align">Spread of genres</h1 >
                                    <canvas id="myChart" width="200" height="200" ></canvas >
                                </div >
                            </div >
                        </div >
                        <div class="col s6 container" >
                            <div class="card white darken-4 black-text" >
                                <div class="card-content" >
                                    <h1 class="center-align">Location spread</h1 >
                                    <canvas id="myChartLocationSpread" width="400" height="400" ></canvas >
                                </div >
                            </div >
                        </div >
                    </div >
                </li >
                <li class="" style="transform: translateX(0px); opacity: 0; " >
                    <div class="row" >
                        <div class="col s1 container" >
                        </div >
                        <div class="col s10 container" >
                            <div class="card white darken-4 black-text" >
                                <div class="card-content" >
                                    <h1 class="center-align">Spread of skills</h1 >
                                    <canvas id="myChartSkills" width="400" height="400" ></canvas >
                                </div >
                            </div >
                        </div >
                        <div class="col s1 container" >
                        </div >
                    </div >
                </li >

                <li class="" style="transform: translateX(0px); opacity: 0; " >
                    <div class="row" >
                        <div class="col s4 container" >
                            <div class="card white darken-4 black-text" >
                                <div class="card-content" >
                                    <h1 class="center-align">Signups per week</h1 >
                                    <canvas id="myChartSignup" width="400" height="400" ></canvas >
                                </div >
                            </div >
                        </div >
                        <div class="col s4 container" >
                            <div class="card white darken-4 black-text" >
                                <div class="card-content" >
                                    <h1 class="center-align">Posts per week</h1 >
                                    <canvas id="myChartPostsPerDay" width="400" height="400" ></canvas >
                                </div >
                            </div >
                        </div >
                        <div class="col s4 container" >
                            <div class="card white darken-4 black-text" >
                                <div class="card-content" >
                                    <h1 class="center-align">Events per week</h1 >
                                    <canvas id="myChartEventsPerDay" width="400" height="400" ></canvas >
                                </div >
                            </div >
                        </div >
                    </div >
                </li >

                <li class="" style="transform: translateX(0px); opacity: 0; " >
                    <div class="row" >
                        <div class="col s4 container" >
                            <div class="card white darken-4 black-text" >
                                <div class="card-content" >
                                    <h1 class="center-align">Daily # of Signups</h1 >
                                    <br >
                                    <%= Reports.users24.count %>
                                </div >
                            </div >
                        </div >
                        <div class="col s4 container" >
                            <div class="card white darken-4 black-text" >
                                <div class="card-content" >
                                    <h1 class="center-align">Daily # of Events created</h1 >
                                    <br >
                                    <%= Reports.events24.count %>
                                </div >
                            </div >
                        </div >
                        <div class="col s4 container" >
                            <div class="card white darken-4 black-text" >
                                <div class="card-content" >
                                    <h1 class="center-align">Daily # of Logins</h1 >
                                    <br >
                                    <%= Reports.usersLogin24.count %>
                                </div >
                            </div >
                        </div >
                    </div >
                </li >
            </ul >
        </div >

    </div >
</main >
<script >

  var ctx2 = document.getElementById('myChartSignup').getContext('2d')
  var myChart2 = new Chart(ctx2, {
    type: 'bar',
    data: {
      labels: [
        'Week4', 'Week3', 'Week2', 'Week1',
      ],
      datasets: [
        {
          label: '# of users per week',
          data: [<%= Reports.usersWeek4 %>,<%= Reports.usersWeek3 %>,<%= Reports.usersWeek2 %>,<%= Reports.usersWeek1 %>],
          borderWidth: 1,
          backgroundColor: [
            hexToRGB('#EF9A9A', 0.7),
            hexToRGB('#DC3912', 0.7),
            hexToRGB('#FF9900', 0.7),
            hexToRGB('#109618', 0.7),
          ],
          borderColor: [
            hexToRGB('#EF9A9A', 0.7),
            hexToRGB('#DC3912', 0.7),
            hexToRGB('#FF9900', 0.7),
            hexToRGB('#109618', 0.7),
          ],
        }],
    },
    options: {
      scales: {
        yAxes: [
          {
            ticks: {
              beginAtZero: true,
            },
          }],
      },
    },
  })

  var ctx4 = document.getElementById('myChartPostsPerDay').getContext('2d')
  var myChart4 = new Chart(ctx4, {
    type: 'bar',
    data: {
      labels: [
        'Week4', 'Week3', 'Week2', 'Week1',
      ],
      datasets: [
        {
          label: '# of posts per week',
          data: [<%= Reports.postsWeek4 %>,<%= Reports.postsWeek3 %>,<%= Reports.postsWeek2 %>,<%= Reports.postsWeek1 %>],
          borderWidth: 1,
          backgroundColor: [
            hexToRGB('#EF9A9A', 0.7),
            hexToRGB('#DC3912', 0.7),
            hexToRGB('#FF9900', 0.7),
            hexToRGB('#109618', 0.7),
          ],
          borderColor: [
            hexToRGB('#EF9A9A', 0.7),
            hexToRGB('#DC3912', 0.7),
            hexToRGB('#FF9900', 0.7),
            hexToRGB('#109618', 0.7),
          ],
        }],
    },
    options: {
      scales: {
        yAxes: [
          {
            ticks: {
              beginAtZero: true,
            },
          }],
      },
    },
  })

  var ctx5 = document.getElementById('myChartEventsPerDay').getContext('2d')
  var myChart5 = new Chart(ctx5, {
    type: 'bar',
    data: {
      labels: [
        'Week4', 'Week3', 'Week2', 'Week1',
      ],
      datasets: [
        {
          label: '# of events created per week',
          data: [<%= Reports.eventsWeek4 %>,<%= Reports.eventsWeek3 %>,<%= Reports.eventsWeek2 %>,<%= Reports.eventsWeek1 %>],
          borderWidth: 1,
          backgroundColor: [
            hexToRGB('#EF9A9A', 0.7),
            hexToRGB('#DC3912', 0.7),
            hexToRGB('#FF9900', 0.7),
            hexToRGB('#109618', 0.7),
          ],
          borderColor: [
            hexToRGB('#EF9A9A', 0.7),
            hexToRGB('#DC3912', 0.7),
            hexToRGB('#FF9900', 0.7),
            hexToRGB('#109618', 0.7),
          ],
        }],
    },
    options: {
      scales: {
        yAxes: [
          {
            ticks: {
              beginAtZero: true,
            },
          }],
      },
    },
  })

  var ctx = document.getElementById('myChart').getContext('2d')
  var myChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: [<% Reports.genres.forEach(function (genre) { %>
        '<%= genre.name %>',
          <% }) %>],
      datasets: [
        {
          label: '# of users',
          data: [<% Reports.genres.forEach(function (genre) { %>
              <%= genre.count %>,
              <% }) %>],
          borderWidth: 1,
          backgroundColor: [
              <% Reports.genres.forEach(function (genre) { %>
            hexToRGB('#' + intToRGB(hashCode('<%= genre.name %>')), 0.7),
              <% }) %>
          ],
          borderColor: [
              <% Reports.genres.forEach(function (genre) { %>
            hexToRGB('#' + intToRGB(hashCode('<%= genre.name %>')), 0.7),
              <% }) %>
          ],

        }],
    },
    options: {
      scales: {
        yAxes: [
          {
            ticks: {
              beginAtZero: true,
            },
          }],
      },
    },
  })

  var ctx6 = document.getElementById('myChartLocationSpread').getContext('2d')
  var myChart6 = new Chart(ctx6, {
    type: 'bar',
    data: {
      labels: [<% Reports.cities.forEach(function (city) { %>
        '<%= city.name %>',
          <% }) %>],
      datasets: [
        {
          label: '# of users from location',
          data: [<% Reports.cities.forEach(function (city) { %>
              <%= city.count %>,
              <% }) %>],
          borderWidth: 1,
          backgroundColor: [
              <% Reports.cities.forEach(function (city) { %>
            hexToRGB('#' + intToRGB(hashCode('<%= city.name %>')), 0.7),
              <% }) %>
          ],
          borderColor: [
              <% Reports.cities.forEach(function (city) { %>
            hexToRGB('#' + intToRGB(hashCode('<%= city.name %>')), 0.7),
              <% }) %>
          ],
        }],
    },
    options: {
      scales: {
        yAxes: [
          {
            ticks: {
              beginAtZero: true,
            },
          }],
      },
    },
  })

  var ctx7 = document.getElementById('myChartSkills').getContext('2d')
  var myChart7 = new Chart(ctx7, {
    type: 'bar',
    data: {
      labels: [<% Reports.skills.forEach(function (skill) { %>
        '<%= skill.name %>',
          <% }) %>],
      datasets: [
        {
          label: '# of users with the skill',
          data: [<% Reports.skills.forEach(function (skill) { %>
              <%= skill.count %>,
              <% }) %>],
          borderWidth: 1,
          backgroundColor: [
              <% Reports.skills.forEach(function (skill) { %>
            hexToRGB('#' + intToRGB(hashCode('<%= skill.name %>')), 0.7),
              <% }) %>
          ],
          borderColor: [
              <% Reports.skills.forEach(function (skill) { %>
            hexToRGB('#' + intToRGB(hashCode('<%= skill.name %>')), 0.7),
              <% }) %>
          ],
        }],
    },
    options: {
      scales: {
        yAxes: [
          {
            ticks: {
              beginAtZero: true,
            },
          }],
      },
    },
  })

  function hashCode (str) { // java String#hashCode
    var hash = 0
    for (var i = 0; i < str.length; i++) {
      hash = str.charCodeAt(i) + ((hash << 5) - hash)
    }
    return hash
  }

  function intToRGB (i) {
    var c = (i & 0x00FFFFFF).toString(16).toUpperCase()

    return '00000'.substring(0, 6 - c.length) + c
  }

  function hexToRGB (hex, alpha) {
    var r = parseInt(hex.slice(1, 3), 16),
      g = parseInt(hex.slice(3, 5), 16),
      b = parseInt(hex.slice(5, 7), 16)

    if (alpha) {
      return 'rgba(' + r + ', ' + g + ', ' + b + ', ' + alpha + ')'
    } else {
      return 'rgb(' + r + ', ' + g + ', ' + b + ')'
    }
  }

</script >
<script >
  Materialize.showStaggeredList('#staggered-test')
  $('.button-collapse').sideNav()

</script >

</body >
</html >
